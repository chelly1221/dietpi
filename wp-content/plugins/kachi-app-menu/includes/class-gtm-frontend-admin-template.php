<?php
/**
 * Google Themed Menu - Frontend Admin Template
 * 
 * ÌîÑÎ°†Ìä∏ÏóîÎìú Í¥ÄÎ¶¨Ïûê ÌéòÏù¥ÏßÄÏùò HTML ÌÖúÌîåÎ¶øÏùÑ Îã¥ÎãπÌïòÎäî ÌÅ¥ÎûòÏä§
 */

// ÏßÅÏ†ë Ï†ëÍ∑º Î∞©ÏßÄ
if (!defined('ABSPATH')) {
    exit;
}

class GTM_Frontend_Admin_Template {
    
    private $core;
    
    public function __construct($core) {
        $this->core = $core;
    }
    
    /**
     * ÌîÑÎ°†Ìä∏ÏóîÎìú Í¥ÄÎ¶¨Ïûê ÌéòÏù¥ÏßÄ Î†åÎçîÎßÅ
     */
    public function render($menu_items, $permissions, $login_settings, $roles) {
        ob_start();
        ?>
        
        <div class="gtm-frontend-admin">
            
            <div class="gtm-fa-container">
                <!-- Ìó§Îçî ÏòÅÏó≠ (Î°úÍ≥† + ÌÉ≠) -->
                <header class="gtm-fa-header-wrapper">
                    <!-- Î°úÍ≥† ÏÑπÏÖò -->
                    <div class="gtm-fa-logo-section">
                        <a href="#" class="gtm-fa-logo">
                            <div class="gtm-fa-logo-icon">‚öôÔ∏è</div>
                            <span>Î©îÎâ¥</span>
                        </a>
                    </div>
                    
                    <!-- ÏÉÅÎã® ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
                    <nav class="gtm-fa-tabs-nav">
                        <a href="#" class="gtm-fa-tab-item active" data-section="menus">
                            <span class="gtm-fa-tab-icon">üìã</span>
                            <span class="gtm-fa-tab-text">Î©îÎâ¥ Í¥ÄÎ¶¨</span>
                        </a>
                        <a href="#" class="gtm-fa-tab-item" data-section="appearance">
                            <span class="gtm-fa-tab-icon">üé®</span>
                            <span class="gtm-fa-tab-text">ÌÖåÎßà ÏÑ§Ï†ï</span>
                        </a>
                        <a href="#" class="gtm-fa-tab-item" data-section="login">
                            <span class="gtm-fa-tab-icon">üîê</span>
                            <span class="gtm-fa-tab-text">Î°úÍ∑∏Ïù∏ ÏÑ§Ï†ï</span>
                        </a>
                        <a href="#" class="gtm-fa-tab-item" data-section="advanced">
                            <span class="gtm-fa-tab-icon">üîß</span>
                            <span class="gtm-fa-tab-text">Í≥†Í∏â ÏÑ§Ï†ï</span>
                        </a>
                    </nav>
                </header>
                
                <!-- Î©îÏù∏ ÏòÅÏó≠ -->
                <main class="gtm-fa-main">
                    <!-- ÏïåÎ¶º ÏòÅÏó≠ -->
                    <div class="gtm-fa-notice" style="display:none;"></div>
                    
                    <!-- Î©îÎâ¥ Í¥ÄÎ¶¨ ÏÑπÏÖò -->
                    <?php $this->render_menu_section($menu_items, $permissions, $roles); ?>
                    
                    <!-- ÌÖåÎßà ÏÑ§Ï†ï ÏÑπÏÖò -->
                    <?php $this->render_appearance_section(); ?>
                    
                    <!-- Î°úÍ∑∏Ïù∏ ÏÑ§Ï†ï ÏÑπÏÖò -->
                    <?php $this->render_login_section($login_settings); ?>
                    
                    <!-- Í≥†Í∏â ÏÑ§Ï†ï ÏÑπÏÖò -->
                    <?php $this->render_advanced_section(); ?>
                </main>
            </div>
            
            <!-- Î©îÎâ¥ Ìé∏Ïßë Î™®Îã¨ -->
            <?php $this->render_edit_modal($roles); ?>
            
        </div>
        
        <?php
        return ob_get_clean();
    }
    
    /**
     * Î©îÎâ¥ Í¥ÄÎ¶¨ ÏÑπÏÖò Î†åÎçîÎßÅ
     */
    private function render_menu_section($menu_items, $permissions, $roles) {
        ?>
        <div class="gtm-fa-section active" data-section="menus">
            <!-- ÏÑπÏÖò Ìó§Îçî -->
            <header class="gtm-fa-section-header">
                <div class="gtm-fa-header-left">
                    <h1 class="gtm-fa-title">Î©îÎâ¥ Í¥ÄÎ¶¨</h1>
                </div>
                <div class="gtm-fa-header-actions">
                    <div class="gtm-fa-search">
                        <input type="text" class="gtm-fa-search-input" placeholder="Î©îÎâ¥ Í≤ÄÏÉâ...">
                        <span class="gtm-fa-search-icon">üîç</span>
                    </div>
                    <button class="gtm-fa-btn-primary gtm-fa-add-menu" type="button">
                        <span class="gtm-fa-icon">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 1V15M1 8H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </span>
                        <span>ÏÉà Î©îÎâ¥</span>
                    </button>
                </div>
            </header>
            
            <!-- ÏΩòÌÖêÏ∏† ÏòÅÏó≠ -->
            <div class="gtm-fa-content">
                <!-- Î©îÎâ¥ Î™©Î°ù -->
                <div class="gtm-fa-menu-list">
                    <div class="gtm-fa-menu-grid">
                        <?php if (!empty($menu_items)) : ?>
                            <?php foreach ($menu_items as $item) : ?>
                                <?php $this->render_menu_item_list($item, $permissions, $roles); ?>
                            <?php endforeach; ?>
                        <?php else : ?>
                            <div class="gtm-fa-empty">
                                <span class="gtm-fa-empty-icon">üì≠</span>
                                <h3>Î©îÎâ¥Í∞Ä ÏóÜÏäµÎãàÎã§</h3>
                                <p>ÏÉà Î©îÎâ¥Î•º Ï∂îÍ∞ÄÌïòÏó¨ ÏãúÏûëÌïòÏÑ∏Ïöî.</p>
                                <button class="gtm-fa-btn-primary gtm-fa-add-menu" type="button">
                                    <span class="gtm-fa-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M8 1V15M1 8H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </span>
                                    Ï≤´ Î©îÎâ¥ Ï∂îÍ∞ÄÌïòÍ∏∞
                                </button>
                            </div>
                        <?php endif; ?>
                    </div>
                </div>
            </div>
        </div>
        <?php
    }
    
    /**
     * Î©îÎâ¥ ÏïÑÏù¥ÌÖú Î†åÎçîÎßÅ - Î™©Î°ù Î∑∞
     */
    private function render_menu_item_list($item, $permissions, $roles) {
        $item_permissions = isset($permissions[$item['id']]) ? $permissions[$item['id']] : array('all');
        ?>
        
        <div class="gtm-fa-menu-item" 
             data-id="<?php echo esc_attr($item['id']); ?>" 
             data-icon="<?php echo esc_attr($item['icon']); ?>"
             data-text="<?php echo esc_attr($item['text']); ?>"
             data-url="<?php echo esc_attr($item['url']); ?>"
             data-guest-action="<?php echo esc_attr($item['guest_action'] ?? 'redirect_login'); ?>"
             data-no-permission-action="<?php echo esc_attr($item['no_permission_action'] ?? 'show_message'); ?>"
             data-no-permission-message="<?php echo esc_attr($item['no_permission_message'] ?? 'Ïù¥ ÌéòÏù¥ÏßÄÏóê Ï†ëÍ∑ºÌï† Í∂åÌïúÏù¥ ÏóÜÏäµÎãàÎã§.'); ?>"
             data-no-permission-redirect="<?php echo esc_attr($item['no_permission_redirect'] ?? '/'); ?>"
             data-permissions="<?php echo esc_attr(json_encode($item_permissions)); ?>">
            
            <div class="gtm-fa-item-header">
                <div class="gtm-fa-item-handle">
                    <span>‚ãÆ‚ãÆ</span>
                </div>
                
                <div class="gtm-fa-item-icon">
                    <?php echo esc_html($item['icon']); ?>
                </div>
                
                <div class="gtm-fa-item-content">
                    <h4 class="gtm-fa-item-title"><?php echo esc_html($item['text']); ?></h4>
                    <div class="gtm-fa-item-url"><?php echo esc_html($item['url']); ?></div>
                    <div class="gtm-fa-item-permissions">
                        <?php $this->render_permission_tags($item_permissions); ?>
                    </div>
                </div>
                
                <div class="gtm-fa-item-actions">
                    <button class="gtm-fa-btn-icon gtm-fa-edit" title="Ìé∏Ïßë" type="button">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14.166 2.5009C14.3849 2.28203 14.6447 2.10842 14.9307 1.98996C15.2167 1.87151 15.5232 1.81055 15.8327 1.81055C16.1422 1.81055 16.4487 1.87151 16.7347 1.98996C17.0206 2.10842 17.2805 2.28203 17.4993 2.5009C17.7182 2.71977 17.8918 2.97961 18.0103 3.26558C18.1287 3.55154 18.1897 3.85804 18.1897 4.16757C18.1897 4.4771 18.1287 4.7836 18.0103 5.06956C17.8918 5.35553 17.7182 5.61537 17.4993 5.83424L6.24935 17.0842L1.66602 18.3342L2.91602 13.7509L14.166 2.5009Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <button class="gtm-fa-btn-icon gtm-fa-delete" title="ÏÇ≠Ï†ú" type="button">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2.5 5H4.16667H17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6.66602 4.99984V3.33317C6.66602 2.89114 6.84161 2.46722 7.15417 2.15466C7.46673 1.8421 7.89066 1.6665 8.33268 1.6665H11.666C12.108 1.6665 12.532 1.8421 12.8445 2.15466C13.1571 2.46722 13.3327 2.89114 13.3327 3.33317V4.99984M15.8327 4.99984V16.6665C15.8327 17.1085 15.6571 17.5325 15.3445 17.845C15.032 18.1576 14.608 18.3332 14.166 18.3332H5.83268C5.39066 18.3332 4.96673 18.1576 4.65417 17.845C4.34161 17.5325 4.16602 17.1085 4.16602 16.6665V4.99984H15.8327Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8.33398 9.1665V14.1665" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M11.666 9.1665V14.1665" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <?php
    }
    
    /**
     * ÌÖåÎßà ÏÑ§Ï†ï ÏÑπÏÖò Î†åÎçîÎßÅ
     */
    private function render_appearance_section() {
        $white_mode_pages = get_option('gtm_white_mode_pages', array());
        if (!is_array($white_mode_pages)) $white_mode_pages = array();
        ?>
        
        <div class="gtm-fa-section" data-section="appearance">
            <header class="gtm-fa-section-header">
                <div class="gtm-fa-header-left">
                    <h1 class="gtm-fa-title">ÌÖåÎßà ÏÑ§Ï†ï</h1>
                </div>
            </header>
            
            <div class="gtm-fa-content">
                <div class="gtm-fa-settings-grid">
                    <!-- ÌôîÏù¥Ìä∏Î™®Îìú ÏÑ§Ï†ï -->
                    <div class="gtm-fa-setting-card">
                        <h3>
                            <span class="gtm-fa-icon">‚òÄÔ∏è</span>
                            ÌôîÏù¥Ìä∏Î™®Îìú ÏÑ§Ï†ï
                        </h3>
                        <p class="gtm-fa-help-text">ÌéòÏù¥ÏßÄÎ≥ÑÎ°ú ÌôîÏù¥Ìä∏Î™®ÎìúÎ•º Ï†ÅÏö©Ìï† Ïàò ÏûàÏäµÎãàÎã§. ÏÑ†ÌÉùÌïòÏßÄ ÏïäÏùÄ ÌéòÏù¥ÏßÄÎäî Îã§ÌÅ¨Î™®ÎìúÎ°ú ÌëúÏãúÎê©ÎãàÎã§.</p>
                        
                        <div class="gtm-fa-page-selector">
                            <!-- ÌôàÌéòÏù¥ÏßÄ -->
                            <div class="gtm-fa-page-item">
                                <label class="gtm-fa-switch">
                                    <input type="checkbox" class="white-mode-page" value="front_page" 
                                        <?php checked(in_array('front_page', $white_mode_pages)); ?>>
                                    <span class="gtm-fa-switch-slider"></span>
                                </label>
                                <div class="gtm-fa-page-info">
                                    <strong>ÌôàÌéòÏù¥ÏßÄ</strong>
                                    <span>ÏÇ¨Ïù¥Ìä∏ Î©îÏù∏ ÌéòÏù¥ÏßÄ</span>
                                </div>
                            </div>
                            
                            <!-- Îã§Î•∏ ÌéòÏù¥ÏßÄÎì§ -->
                            <?php
                            $pages = get_pages(array(
                                'sort_order' => 'asc',
                                'sort_column' => 'post_title',
                            ));
                            
                            foreach ($pages as $page) :
                            ?>
                            <div class="gtm-fa-page-item">
                                <label class="gtm-fa-switch">
                                    <input type="checkbox" class="white-mode-page" value="<?php echo $page->ID; ?>" 
                                        <?php checked(in_array($page->ID, $white_mode_pages)); ?>>
                                    <span class="gtm-fa-switch-slider"></span>
                                </label>
                                <div class="gtm-fa-page-info">
                                    <strong><?php echo esc_html($page->post_title); ?></strong>
                                    <span>ID: <?php echo $page->ID; ?></span>
                                </div>
                            </div>
                            <?php endforeach; ?>
                        </div>
                    </div>
                    
                    <!-- Î©îÎâ¥ Ïä§ÌÉÄÏùº ÏÑ§Ï†ï -->
                    <div class="gtm-fa-setting-card">
                        <h3>
                            <span class="gtm-fa-icon">üé®</span>
                            Î©îÎâ¥ Ïä§ÌÉÄÏùº
                        </h3>
                        <p class="gtm-fa-help-text">Î©îÎâ¥Ïùò Í∏∞Î≥∏ Ïä§ÌÉÄÏùºÏùÑ ÏÑ§Ï†ïÌï©ÎãàÎã§.</p>
                        
                        <div class="gtm-fa-form-group">
                            <label>Î©îÎâ¥ ÏúÑÏπò</label>
                            <select class="gtm-fa-select" id="menu-position">
                                <option value="top-right">ÏÉÅÎã® Ïö∞Ï∏°</option>
                                <option value="top-left">ÏÉÅÎã® Ï¢åÏ∏°</option>
                                <option value="bottom-right">ÌïòÎã® Ïö∞Ï∏°</option>
                                <option value="bottom-left">ÌïòÎã® Ï¢åÏ∏°</option>
                            </select>
                        </div>
                        
                        <div class="gtm-fa-form-group">
                            <label>Î©îÎâ¥ ÌÅ¨Í∏∞</label>
                            <select class="gtm-fa-select" id="menu-size">
                                <option value="small">ÏûëÍ≤å</option>
                                <option value="medium" selected>Î≥¥ÌÜµ</option>
                                <option value="large">ÌÅ¨Í≤å</option>
                            </select>
                        </div>
                        
                        <div class="gtm-fa-form-group">
                            <label>Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º</label>
                            <label class="gtm-fa-switch">
                                <input type="checkbox" id="menu-animation" checked>
                                <span class="gtm-fa-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <?php
    }
    
    /**
     * Î°úÍ∑∏Ïù∏ ÏÑ§Ï†ï ÏÑπÏÖò Î†åÎçîÎßÅ
     */
    private function render_login_section($login_settings) {
        ?>
        
        <div class="gtm-fa-section" data-section="login">
            <header class="gtm-fa-section-header">
                <div class="gtm-fa-header-left">
                    <h1 class="gtm-fa-title">Î°úÍ∑∏Ïù∏ ÏÑ§Ï†ï</h1>
                </div>
            </header>
            
            <div class="gtm-fa-content">
                <div class="gtm-fa-settings-group">
                    <h3>Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄ</h3>
                    <p class="gtm-fa-help-text">ÏÇ¨Ïö©ÏûêÍ∞Ä Î°úÍ∑∏Ïù∏Ìï† ÌéòÏù¥ÏßÄÎ•º ÏÑ§Ï†ïÌï©ÎãàÎã§.</p>
                    
                    <div class="gtm-fa-form-group">
                        <label>Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄ ÏÑ†ÌÉù</label>
                        <select class="gtm-fa-select" id="login-page-id">
                            <?php
                            $pages = get_pages();
                            foreach ($pages as $page) {
                                $selected = ($login_settings['login_page_id'] == $page->ID) ? 'selected' : '';
                                echo '<option value="' . $page->ID . '" ' . $selected . '>' . esc_html($page->post_title) . '</option>';
                            }
                            ?>
                        </select>
                    </div>
                </div>
                
                <div class="gtm-fa-settings-group">
                    <h3>Î¶¨Îã§Ïù¥Î†âÌä∏ ÏÑ§Ï†ï</h3>
                    <p class="gtm-fa-help-text">Î°úÍ∑∏Ïù∏/Î°úÍ∑∏ÏïÑÏõÉ ÌõÑ Ïù¥ÎèôÌï† ÌéòÏù¥ÏßÄÎ•º ÏÑ§Ï†ïÌï©ÎãàÎã§.</p>
                    
                    <div class="gtm-fa-form-row">
                        <div class="gtm-fa-form-group">
                            <label>Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Îèô</label>
                            <select class="gtm-fa-select" id="login-redirect">
                                <option value="previous_page" <?php selected($login_settings['login_redirect'], 'previous_page'); ?>>Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄÎ°ú</option>
                                <option value="home" <?php selected($login_settings['login_redirect'], 'home'); ?>>ÌôàÌéòÏù¥ÏßÄÎ°ú</option>
                                <option value="custom" <?php selected($login_settings['login_redirect'], 'custom'); ?>>ÏÇ¨Ïö©Ïûê Ï†ïÏùò</option>
                            </select>
                            
                            <div class="gtm-fa-sub-group" id="custom-login-redirect-group" style="<?php echo $login_settings['login_redirect'] !== 'custom' ? 'display:none;' : ''; ?>">
                                <input type="text" class="gtm-fa-input" id="custom-login-redirect" 
                                    value="<?php echo esc_attr($login_settings['custom_login_redirect']); ?>" 
                                    placeholder="/dashboard">
                                <small>ÏÇ¨Ïö©Ïûê Ï†ïÏùò URLÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî</small>
                            </div>
                        </div>
                        
                        <div class="gtm-fa-form-group">
                            <label>Î°úÍ∑∏ÏïÑÏõÉ ÌõÑ Ïù¥Îèô</label>
                            <input type="text" class="gtm-fa-input" id="logout-redirect" 
                                value="<?php echo esc_attr($login_settings['logout_redirect']); ?>" 
                                placeholder="/">
                            <small>Î°úÍ∑∏ÏïÑÏõÉ ÌõÑ Ïù¥ÎèôÌï† URL</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <?php
    }
    
    /**
     * Í≥†Í∏â ÏÑ§Ï†ï ÏÑπÏÖò Î†åÎçîÎßÅ
     */
    private function render_advanced_section() {
        ?>
        
        <div class="gtm-fa-section" data-section="advanced">
            <header class="gtm-fa-section-header">
                <div class="gtm-fa-header-left">
                    <h1 class="gtm-fa-title">Í≥†Í∏â ÏÑ§Ï†ï</h1>
                </div>
            </header>
            
            <div class="gtm-fa-content">
                <div class="gtm-fa-advanced-section">
                    <h3>Î∞±ÏóÖ Î∞è Î≥µÏõê</h3>
                    <p class="gtm-fa-help-text">ÏÑ§Ï†ïÏùÑ Î∞±ÏóÖÌïòÍ±∞ÎÇò Î≥µÏõêÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                    
                    <div class="gtm-fa-button-group">
                        <button class="gtm-fa-btn-secondary" id="export-settings">
                            <span class="gtm-fa-icon">üì•</span>
                            ÏÑ§Ï†ï ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                        </button>
                        <button class="gtm-fa-btn-secondary" id="import-settings">
                            <span class="gtm-fa-icon">üì§</span>
                            ÏÑ§Ï†ï Í∞ÄÏ†∏Ïò§Í∏∞
                        </button>
                    </div>
                </div>
                
                <div class="gtm-fa-advanced-section">
                    <h3>Ï¥àÍ∏∞Ìôî</h3>
                    <p class="gtm-fa-help-text">Î™®Îì† ÏÑ§Ï†ïÏùÑ Í∏∞Î≥∏Í∞íÏúºÎ°ú Ï¥àÍ∏∞ÌôîÌï©ÎãàÎã§.</p>
                    
                    <button class="gtm-fa-btn-danger" id="reset-settings">
                        <span class="gtm-fa-icon">‚ö†Ô∏è</span>
                        ÏÑ§Ï†ï Ï¥àÍ∏∞Ìôî
                    </button>
                </div>
                
                <div class="gtm-fa-advanced-section">
                    <h3>ÏãúÏä§ÌÖú Ï†ïÎ≥¥</h3>
                    <div class="gtm-fa-system-info">
                        <p><strong>ÌîåÎü¨Í∑∏Ïù∏ Î≤ÑÏ†Ñ:</strong> <?php echo GTM_VERSION; ?></p>
                        <p><strong>WordPress Î≤ÑÏ†Ñ:</strong> <?php echo get_bloginfo('version'); ?></p>
                        <p><strong>PHP Î≤ÑÏ†Ñ:</strong> <?php echo phpversion(); ?></p>
                        <p><strong>ÌôúÏÑ± ÌÖåÎßà:</strong> <?php echo wp_get_theme()->get('Name'); ?></p>
                    </div>
                </div>
            </div>
        </div>
        
        <?php
    }
    
    /**
     * Í∂åÌïú ÌÉúÍ∑∏ Î†åÎçîÎßÅ
     */
    private function render_permission_tags($permissions) {
        if (in_array('guest', $permissions)) {
            echo '<span class="gtm-fa-tag gtm-fa-tag-guest">Î™®Îì† ÏÇ¨Ïö©Ïûê</span>';
        } elseif (in_array('all', $permissions)) {
            echo '<span class="gtm-fa-tag gtm-fa-tag-all">Î°úÍ∑∏Ïù∏ ÏÇ¨Ïö©Ïûê</span>';
        } else {
            foreach ($permissions as $permission) {
                $label = $this->get_role_label($permission);
                echo '<span class="gtm-fa-tag">' . esc_html($label) . '</span>';
            }
        }
    }
    
    /**
     * Ïó≠Ìï† Î†àÏù¥Î∏î Í∞ÄÏ†∏Ïò§Í∏∞
     */
    private function get_role_label($role) {
        $labels = array(
            'administrator' => 'Í∞úÎ∞úÏûê',
            'approver' => 'Í¥ÄÎ¶¨Ïûê',
            'pending' => 'ÏäπÏù∏ ÎåÄÍ∏∞',
            'subscriber' => 'ÏÇ¨Ïö©Ïûê',
            // Í∏∞ÌÉÄ Ïó≠Ìï†Îì§ (ÌëúÏãúÎäî ÏïàÎêòÏßÄÎßå ÌòπÏãú Îç∞Ïù¥ÌÑ∞Ïóê ÏûàÏùÑ Í≤ΩÏö∞Î•º ÏúÑÌï¥)
            'editor' => 'Ìé∏ÏßëÏûê',
            'author' => 'Í∏ÄÏì¥Ïù¥',
            'contributor' => 'Í∏∞Ïó¨Ïûê'
        );
        
        return isset($labels[$role]) ? $labels[$role] : $role;
    }
    
    /**
     * Ìé∏Ïßë Î™®Îã¨ Î†åÎçîÎßÅ
     */
    private function render_edit_modal($roles) {
        // ÌëúÏãúÌï† Ïó≠Ìï†Îßå ÌïÑÌÑ∞ÎßÅ
        $allowed_roles = array(
            'administrator' => 'Í∞úÎ∞úÏûê',
            'approver' => 'Í¥ÄÎ¶¨Ïûê',
            'pending' => 'ÏäπÏù∏ ÎåÄÍ∏∞',
            'subscriber' => 'ÏÇ¨Ïö©Ïûê'
        );
        ?>
        
        <div class="gtm-fa-modal" style="display:none;">
            <div class="gtm-fa-modal-content">
                <div class="gtm-fa-modal-header">
                    <h3 class="gtm-fa-modal-title">Î©îÎâ¥ Ìé∏Ïßë</h3>
                    <button class="gtm-fa-modal-close" type="button">&times;</button>
                </div>
                
                <div class="gtm-fa-modal-body">
                    <input type="hidden" class="gtm-fa-menu-id">
                    
                    <div class="gtm-fa-form-row">
                        <div class="gtm-fa-form-group">
                            <label>ÏïÑÏù¥ÏΩò</label>
                            <input type="text" class="gtm-fa-input gtm-fa-menu-icon" placeholder="Ïòà: üè†">
                            <small>Ïù¥Î™®ÏßÄÎÇò ÌÖçÏä§Ìä∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî</small>
                        </div>
                        
                        <div class="gtm-fa-form-group">
                            <label>Î©îÎâ¥ Ïù¥Î¶Ñ</label>
                            <input type="text" class="gtm-fa-input gtm-fa-menu-text" placeholder="Î©îÎâ¥ Ïù¥Î¶Ñ">
                        </div>
                    </div>
                    
                    <div class="gtm-fa-form-group">
                        <label>URL</label>
                        <input type="text" class="gtm-fa-input gtm-fa-menu-url" placeholder="Ïòà: /?page_id=123">
                        <small>Ï†àÎåÄ Í≤ΩÎ°ú ÎòêÎäî ÏÉÅÎåÄ Í≤ΩÎ°úÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî</small>
                    </div>
                    
                    <div class="gtm-fa-form-group">
                        <label>Ï†ëÍ∑º Í∂åÌïú</label>
                        <div class="gtm-fa-permission-grid">
                            <label class="gtm-fa-checkbox">
                                <input type="checkbox" name="permissions" value="guest" class="gtm-fa-permission-checkbox">
                                <span>Î™®Îì† ÏÇ¨Ïö©Ïûê (ÎπÑÎ°úÍ∑∏Ïù∏ Ìè¨Ìï®)</span>
                            </label>
                            <label class="gtm-fa-checkbox">
                                <input type="checkbox" name="permissions" value="all" class="gtm-fa-permission-checkbox">
                                <span>Î°úÍ∑∏Ïù∏ ÏÇ¨Ïö©Ïûê</span>
                            </label>
                            <?php foreach ($allowed_roles as $role_key => $role_name) : ?>
                            <label class="gtm-fa-checkbox">
                                <input type="checkbox" name="permissions" value="<?php echo esc_attr($role_key); ?>" class="gtm-fa-permission-checkbox">
                                <span><?php echo esc_html($role_name); ?></span>
                            </label>
                            <?php endforeach; ?>
                        </div>
                    </div>
                    
                    <div class="gtm-fa-form-row">
                        <div class="gtm-fa-form-group">
                            <label>ÎπÑÎ°úÍ∑∏Ïù∏ ÏÇ¨Ïö©Ïûê Ï†ëÍ∑º Ïãú</label>
                            <select class="gtm-fa-select gtm-fa-guest-action">
                                <option value="allow">Ï†ëÍ∑º ÌóàÏö©</option>
                                <option value="redirect_login">Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄÎ°ú</option>
                                <option value="show_message">Î©îÏãúÏßÄ ÌëúÏãú</option>
                            </select>
                        </div>
                        
                        <div class="gtm-fa-form-group">
                            <label>Í∂åÌïú ÏóÜÎäî ÏÇ¨Ïö©Ïûê Ï†ëÍ∑º Ïãú</label>
                            <select class="gtm-fa-select gtm-fa-no-permission-action">
                                <option value="show_message">Î©îÏãúÏßÄ ÌëúÏãú</option>
                                <option value="redirect_home">ÌôàÏúºÎ°ú Ïù¥Îèô</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="gtm-fa-form-group">
                        <label>Ï†ëÍ∑º Í±∞Î∂Ä Î©îÏãúÏßÄ</label>
                        <textarea class="gtm-fa-textarea gtm-fa-no-permission-message" rows="2">Ïù¥ ÌéòÏù¥ÏßÄÏóê Ï†ëÍ∑ºÌï† Í∂åÌïúÏù¥ ÏóÜÏäµÎãàÎã§.</textarea>
                    </div>
                </div>
                
                <div class="gtm-fa-modal-footer">
                    <button class="gtm-fa-btn-secondary gtm-fa-modal-cancel" type="button">Ï∑®ÏÜå</button>
                    <button class="gtm-fa-btn-primary gtm-fa-save-menu" type="button">
                        <span class="gtm-fa-icon">üíæ</span>
                        Ï†ÄÏû•
                    </button>
                </div>
            </div>
        </div>
        
        <?php
    }
}